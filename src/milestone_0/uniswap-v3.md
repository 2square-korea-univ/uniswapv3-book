## Uniswap V3 ì†Œê°œ

> ì´ ì¥ì—ì„œëŠ” [Uniswap V3 ë°±ì„œ](https://uniswap.org/whitepaper-v3.pdf)ë¥¼ ë‹¤ì‹œ ì„¤ëª…í•©ë‹ˆë‹¤. ëª¨ë“  ê°œë…ì„ ì´í•´í•˜ì§€ ëª»í•´ë„ ê´œì°®ìŠµë‹ˆë‹¤. ì½”ë“œë¡œ ë³€í™˜ë  ë•Œ ë” ëª…í™•í•´ì§ˆ ê²ƒì…ë‹ˆë‹¤.

Uniswap V3ê°€ ê°€ì ¸ì˜¨ í˜ì‹ ì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•´ ë¨¼ì € Uniswap V2ì˜ ë¶ˆì™„ì „ì„±ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

Uniswap V2ëŠ” ë‹¨ì¼ AMM ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ëŠ” ì¼ë°˜ì ì¸ ê±°ë˜ì†Œì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëª¨ë“  ê±°ë˜ ìŒì´ ë™ì¼í•œ ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ìŒì€ ê°€ê²© ë³€ë™ì„±ì— ë”°ë¼ ê·¸ë£¹í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. ì¤‘ê°„ ë° ë†’ì€ ê°€ê²© ë³€ë™ì„±ì„ ê°€ì§„ í† í°. ì´ ê·¸ë£¹ì€ ëŒ€ë¶€ë¶„ì˜ í† í°ì„ í¬í•¨í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ëŒ€ë¶€ë¶„ì˜ í† í°ì€ ê°€ê²©ì´ ê³ ì •ë˜ì–´ ìˆì§€ ì•Šê³  ì‹œì¥ ë³€ë™ì— ì˜í–¥ì„ ë°›ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
2. ë‚®ì€ ë³€ë™ì„±ì„ ê°€ì§„ í† í°. ì´ ê·¸ë£¹ì—ëŠ” í˜ê¹…ëœ í† í°, ì£¼ë¡œ ìŠ¤í…Œì´ë¸” ì½”ì¸ì´ í¬í•¨ë©ë‹ˆë‹¤. USDC/USDT, USDC/DAI, USDT/DAI ë“±ì…ë‹ˆë‹¤. ë˜í•œ ETH/stETH, ETH/rETH (ë©í•‘ëœ ETHì˜ ë³€í˜•)ë„ í¬í•¨ë©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ê·¸ë£¹ì€ ì„œë¡œ ë‹¤ë¥¸, ì†Œìœ„ ë§í•˜ëŠ” í’€ êµ¬ì„±ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ì£¼ìš” ì°¨ì´ì ì€ í˜ê¹…ëœ í† í°ì€ í° ê±°ë˜ì—ì„œ ìˆ˜ìš” íš¨ê³¼(ì´ì „ ì¥ì—ì„œ ë°°ì›€)ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ë†’ì€ ìœ ë™ì„±ì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. USDCì™€ USDTì˜ ê°€ê²©ì€ êµ¬ë§¤ ë° íŒë§¤í•˜ë ¤ëŠ” í† í° ìˆ˜ì— ê´€ê³„ì—†ì´ 1ì— ê°€ê¹Œì›Œì•¼ í•©ë‹ˆë‹¤. Uniswap V2ì˜ ì¼ë°˜ì ì¸ AMM ì•Œê³ ë¦¬ì¦˜ì€ ìŠ¤í…Œì´ë¸” ì½”ì¸ ê±°ë˜ì— ì í•©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ëŒ€ì²´ AMM (ì£¼ë¡œ [Curve](https://curve.fi))ì´ ìŠ¤í…Œì´ë¸” ì½”ì¸ ê±°ë˜ì— ë” ë§ì´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ ë¬¸ì œì˜ ì›ì¸ì€ Uniswap V2 í’€ì˜ ìœ ë™ì„±ì´ ë¬´í•œíˆ ë¶„ì‚°ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. í’€ ìœ ë™ì„±ì€ 0ì—ì„œ ë¬´í•œëŒ€ê¹Œì§€ ëª¨ë“  ê°€ê²©ì—ì„œ ê±°ë˜ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.



![ê³¡ì„ ì€ ë¬´í•œí•©ë‹ˆë‹¤](images/curve_infinite.png)

ì´ê²ƒì´ ë‚˜ìœ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ ì•Šì„ ìˆ˜ë„ ìˆì§€ë§Œ, ìë³¸ ë¹„íš¨ìœ¨ì„±ì„ ì•¼ê¸°í•©ë‹ˆë‹¤. ìì‚°ì˜ ê³¼ê±° ê°€ê²©ì€ ì¢ë“  ë„“ë“  ì •ì˜ëœ ë²”ìœ„ ë‚´ì— ë¨¸ë¬´ë¦…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ETHì˜ ê³¼ê±° ê°€ê²© ë²”ìœ„ëŠ” $0.75ì—ì„œ $4,800ì…ë‹ˆë‹¤([CoinMarketCap](https://coinmarketcap.com/currencies/ethereum/) ê¸°ì¤€). ì˜¤ëŠ˜(2022ë…„ 6ì›”, 1 ETHëŠ” \$1,800), ì•„ë¬´ë„ \$5000ì— 1 ì´ë”ë¥¼ ì‚¬ì§€ ì•Šì„ ê²ƒì´ë¯€ë¡œ ì´ ê°€ê²©ì—ì„œ ìœ ë™ì„±ì„ ì œê³µí•˜ëŠ” ê²ƒì€ ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í˜„ì¬ ê°€ê²©ì—ì„œ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆê±°ë‚˜ ê²°ì½” ë„ë‹¬í•˜ì§€ ì•Šì„ ê°€ê²© ë²”ìœ„ì—ì„œ ìœ ë™ì„±ì„ ì œê³µí•˜ëŠ” ê²ƒì€ ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤.

> í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ëª¨ë‘ ETHê°€ ì–¸ì  ê°€ \$10,000ì— ë„ë‹¬í•  ê²ƒì´ë¼ê³  ë¯¿ìŠµë‹ˆë‹¤.

## ì§‘ì¤‘ëœ ìœ ë™ì„±

Uniswap V3ëŠ” *ì§‘ì¤‘ëœ ìœ ë™ì„±*ì„ ë„ì…í–ˆìŠµë‹ˆë‹¤. ìœ ë™ì„± ê³µê¸‰ìëŠ” ì´ì œ ìœ ë™ì„±ì„ ì œê³µí•˜ë ¤ëŠ” ê°€ê²© ë²”ìœ„ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì¢ì€ ê°€ê²© ë²”ìœ„ì— ë” ë§ì€ ìœ ë™ì„±ì„ íˆ¬ì…í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ìë³¸ íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¤ê³ , Uniswapì„ ë”ìš± ë‹¤ì–‘í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. ì´ì œ ë‹¤ì–‘í•œ ë³€ë™ì„±ì„ ê°€ì§„ ìŒì— ëŒ€í•´ í’€ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ V3ê°€ V2ë¥¼ ê°œì„ í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

ê°„ë‹¨íˆ ë§í•´ì„œ, Uniswap V3 ìŒì€ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ Uniswap V2 ìŒì…ë‹ˆë‹¤. V2ì™€ V3ì˜ ì£¼ìš” ì°¨ì´ì ì€ V3ì—ì„œëŠ” í•˜ë‚˜ì˜ ìŒì— **ë§ì€ ê°€ê²© ë²”ìœ„**ê°€ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ ê° ì§§ì€ ê°€ê²© ë²”ìœ„ëŠ” **ìœ í•œí•œ ì¤€ë¹„ê¸ˆ**ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. 0ì—ì„œ ë¬´í•œëŒ€ê¹Œì§€ì˜ ì „ì²´ ê°€ê²© ë²”ìœ„ëŠ” ë” ì§§ì€ ê°€ê²© ë²”ìœ„ë¡œ ë¶„í• ë˜ë©°, ê° ë²”ìœ„ëŠ” ìì²´ ìœ ë™ì„± ì–‘ì„ ê°–ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì¤‘ìš”í•œ ê²ƒì€ ê·¸ ì§§ì€ ê°€ê²© ë²”ìœ„ ë‚´ì—ì„œëŠ” **Uniswap V2ì™€ ì •í™•íˆ ë™ì¼í•˜ê²Œ ì‘ë™**í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì´ ì œê°€ V3 ìŒì´ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ V2 ìŒì´ë¼ê³  ë§í•˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤.

ì´ì œ ì‹œê°í™”í•´ ë³´ê² ìŠµë‹ˆë‹¤. ìš°ë¦¬ê°€ ë§í•˜ëŠ” ê²ƒì€ ê³¡ì„ ì´ ë¬´í•œí•˜ì§€ ì•Šê¸°ë¥¼ ë°”ë€ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê³¡ì„ ì„ ì  $a$ì™€ $b$ì—ì„œ ìë¥´ê³  ì´ë“¤ì´ ê³¡ì„ ì˜ ê²½ê³„ë¼ê³  ë§í•©ë‹ˆë‹¤. ë˜í•œ ê²½ê³„ê°€ ì¶•ì— ë†“ì´ë„ë¡ ê³¡ì„ ì„ ì´ë™í•©ë‹ˆë‹¤. ì´ê²ƒì´ ìš°ë¦¬ê°€ ì–»ëŠ” ê²ƒì…ë‹ˆë‹¤.



![Uniswap V3 ê°€ê²© ë²”ìœ„](images/curve_finite.png)

> ì™¸ë¡œì›Œ ë³´ì´ì§€ ì•Šë‚˜ìš”? ì´ê²ƒì´ Uniswap V3ì— ë§ì€ ê°€ê²© ë²”ìœ„ê°€ ìˆëŠ” ì´ìœ ì…ë‹ˆë‹¤. ì™¸ë¡­ì§€ ì•Šë„ë¡ìš” ğŸ™‚

ì´ì „ ì¥ì—ì„œ ë³´ì•˜ë“¯ì´ í† í°ì„ ì‚¬ê³ íŒŒëŠ” ê²ƒì€ ê°€ê²©ì„ ê³¡ì„ ì„ ë”°ë¼ ì´ë™ì‹œí‚µë‹ˆë‹¤. ê°€ê²© ë²”ìœ„ëŠ” ê°€ê²© ì´ë™ì„ ì œí•œí•©ë‹ˆë‹¤. ê°€ê²©ì´ ì–´ëŠ í•œ ì§€ì ìœ¼ë¡œ ì´ë™í•˜ë©´ í’€ì€ **ê³ ê°ˆ**ë©ë‹ˆë‹¤. í† í° ì¤€ë¹„ê¸ˆ ì¤‘ í•˜ë‚˜ê°€ 0ì´ ë˜ê³ , ì´ í† í°ì„ êµ¬ë§¤í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

ìœ„ ì°¨íŠ¸ì—ì„œ ì‹œì‘ ê°€ê²©ì´ ê³¡ì„ ì˜ ì¤‘ê°„ì— ìˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì  $a$ì— ë„ë‹¬í•˜ë ¤ë©´ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  $y$ë¥¼ êµ¬ë§¤í•˜ê³  ë²”ìœ„ ë‚´ì—ì„œ $x$ë¥¼ ìµœëŒ€í™”í•´ì•¼ í•©ë‹ˆë‹¤. ì  $b$ì— ë„ë‹¬í•˜ë ¤ë©´ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  $x$ë¥¼ êµ¬ë§¤í•˜ê³  ë²”ìœ„ ë‚´ì—ì„œ $y$ë¥¼ ìµœëŒ€í™”í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì§€ì ì—ì„œëŠ” ë²”ìœ„ ë‚´ì— í† í°ì´ í•˜ë‚˜ë§Œ ìˆìŠµë‹ˆë‹¤!

> ì¬ë¯¸ìˆëŠ” ì‚¬ì‹¤: ì´ê²ƒì€ Uniswap V3 ê°€ê²© ë²”ìœ„ë¥¼ ì§€ì •ê°€ ì£¼ë¬¸ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤!

ê±°ë˜ ì¤‘ì— í˜„ì¬ ê°€ê²© ë²”ìœ„ê°€ ê³ ê°ˆë˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? ê°€ê²©ì€ ë‹¤ìŒ ê°€ê²© ë²”ìœ„ë¡œ ë¯¸ë„ëŸ¬ì§‘ë‹ˆë‹¤. ë‹¤ìŒ ê°€ê²© ë²”ìœ„ê°€ ì—†ìœ¼ë©´ ê±°ë˜ëŠ” ë¶€ë¶„ì ìœ¼ë¡œë§Œ ì™„ë£Œë©ë‹ˆë‹¤. ì´ ì‘ë™ ë°©ì‹ì€ ì±…ì˜ ë’·ë¶€ë¶„ì—ì„œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

ë‹¤ìŒì€ [ì‹¤ì œ USDC/ETH í’€](https://info.uniswap.org/#/pools/0x8ad599c3a0ff1de082011efddc58f1908eb6e6d8)ì—ì„œ ìœ ë™ì„±ì´ ë¶„ì‚°ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.



![ì‹¤ì œ USDC/ETH í’€ì˜ ìœ ë™ì„±](images/usdceth_liquidity.png)

í˜„ì¬ ê°€ê²© ì£¼ë³€ì— ë§ì€ ìœ ë™ì„±ì´ ìˆì§€ë§Œ, ê°€ê²©ì—ì„œ ë©€ì–´ì§ˆìˆ˜ë¡ ìœ ë™ì„±ì´ ì¤„ì–´ë“œëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ìœ ë™ì„± ê³µê¸‰ìê°€ ìë³¸ íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ë…¸ë ¥í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë˜í•œ ì „ì²´ ë²”ìœ„ê°€ ë¬´í•œí•˜ì§€ ì•Šê³ , ìƒí•œì„ ì´ ì´ë¯¸ì§€ì— í‘œì‹œë©ë‹ˆë‹¤.

## Uniswap V3ì˜ ìˆ˜í•™

ìˆ˜í•™ì ìœ¼ë¡œ Uniswap V3ëŠ” V2ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤. ë™ì¼í•œ ê³µì‹ì„ ì‚¬ìš©í•˜ì§€ë§Œ... *í™•ì¥*ë˜ì—ˆë‹¤ê³  ë¶€ë¥´ê² ìŠµë‹ˆë‹¤.

ê°€ê²© ë²”ìœ„ ê°„ ì „í™˜ì„ ì²˜ë¦¬í•˜ê³ , ìœ ë™ì„± ê´€ë¦¬ë¥¼ ë‹¨ìˆœí™”í•˜ê³ , ë°˜ì˜¬ë¦¼ ì˜¤ë¥˜ë¥¼ í”¼í•˜ê¸° ìœ„í•´ Uniswap V3ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìƒˆë¡œìš´ ê°œë…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

$$L = \sqrt{xy}$$

$$\sqrt{P} = \sqrt{\frac{y}{x}}$$

$L$ì€ *ìœ ë™ì„± ì–‘*ì…ë‹ˆë‹¤. í’€ì˜ ìœ ë™ì„±ì€ í† í° ì¤€ë¹„ê¸ˆì˜ ì¡°í•©(ì¦‰, ë‘ ìˆ«ì)ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê·¸ë“¤ì˜ ê³±ì´ $k$ë¼ëŠ” ê²ƒì„ ì•Œê³  ìˆìœ¼ë©°, ì´ê²ƒì„ ì‚¬ìš©í•˜ì—¬ ìœ ë™ì„± ì¸¡ì •ì„ ìœ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ê²ƒì€ $\sqrt{xy}$ì…ë‹ˆë‹¤. ì œê³±í•˜ë©´ $k$ì™€ ê°™ì•„ì§€ëŠ” ìˆ«ìì…ë‹ˆë‹¤. $L$ì€ $x$ì™€ $y$ì˜ ê¸°í•˜ í‰ê· ì…ë‹ˆë‹¤.

$y/x$ëŠ” í† í° 1ì— ëŒ€í•œ í† í° 0ì˜ ê°€ê²©ì…ë‹ˆë‹¤. í’€ì˜ í† í° ê°€ê²©ì€ ì„œë¡œ ì—­ìˆ˜ì´ë¯€ë¡œ ê³„ì‚°ì— í•˜ë‚˜ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê·¸ë¦¬ê³  ê´€ë¡€ìƒ Uniswap V3ëŠ” $y/x$ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤). í† í° 0ì— ëŒ€í•œ í† í° 1ì˜ ê°€ê²©ì€ ë‹¨ìˆœíˆ $\frac{1}{y/x}=\frac{x}{y}$ì…ë‹ˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ, $\frac{1}{\sqrt{P}} = \frac{1}{\sqrt{y/x}} = \sqrt{\frac{x}{y}}$ì…ë‹ˆë‹¤.

$p$ ëŒ€ì‹  $\sqrt{p}$ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë‘ ê°€ì§€ì…ë‹ˆë‹¤.

1. ì œê³±ê·¼ ê³„ì‚°ì€ ì •í™•í•˜ì§€ ì•Šê³  ë°˜ì˜¬ë¦¼ ì˜¤ë¥˜ë¥¼ ìœ ë°œí•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê³„ì•½ì—ì„œ ê³„ì‚°í•˜ì§€ ì•Šê³  ì œê³±ê·¼ì„ ì €ì¥í•˜ëŠ” ê²ƒì´ ë” ì‰½ìŠµë‹ˆë‹¤(ê³„ì•½ì— $x$ì™€ $y$ë¥¼ ì €ì¥í•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤).
2. $\sqrt{P}$ëŠ” $L$ê³¼ í¥ë¯¸ë¡œìš´ ê´€ê³„ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. $L$ì€ ì¶œë ¥ëŸ‰ ë³€í™”ì™€ $\sqrt{P}$ ë³€í™” ì‚¬ì´ì˜ ê´€ê³„ì´ê¸°ë„ í•©ë‹ˆë‹¤.

    $$L = \frac{\Delta y}{\Delta\sqrt{P}}$$

> ì¦ëª…:
$$L = \frac{\Delta y}{\Delta\sqrt{P}}$$
$$\sqrt{xy} = \frac{y_1 - y_0}{\sqrt{P_1} - \sqrt{P_0}}$$
$$\sqrt{xy} (\sqrt{P_1} - \sqrt{P_0}) = y_1 - y_0$$
$$\sqrt{xy} (\sqrt{\frac{y_1}{x_1}} - \sqrt{\frac{y_0}{x_0}}) = y_1 - y_0$$
$$\textrm{Since } \sqrt{x_1y_1} = \sqrt{x_0y_0} = \sqrt{xy} = L,$$
$$\sqrt{\frac{x_1y_1y_1}{x_1}} - \sqrt{\frac{x_0y_0y_0}{x_0}} = y_1 - y_0$$
$$\sqrt{y_1^2} - \sqrt{y_0^2} = y_1 - y_0$$
$$y_1 - y_0 = y_1 - y_0$$

## ê°€ê²© ì±…ì •

ë‹¤ì‹œ ë§í•˜ì§€ë§Œ, ì‹¤ì œ ê°€ê²©ì„ ê³„ì‚°í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ì¶œë ¥ëŸ‰ì„ ë°”ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ $x$ì™€ $y$ë¥¼ ì¶”ì í•˜ê³  ì €ì¥í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê³„ì‚°ì€ $L$ê³¼ $\sqrt{P}$ë§Œì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.

ìœ„ì˜ ê³µì‹ì—ì„œ $\Delta y$ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

$$\Delta y = \Delta \sqrt{P} L$$

> ìœ„ì˜ ì¦ëª…ì—ì„œ ì„¸ ë²ˆì§¸ ë‹¨ê³„ë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.

ìœ„ì—ì„œ ë…¼ì˜í•œ ë°”ì™€ ê°™ì´ í’€ì˜ ê°€ê²©ì€ ì„œë¡œ ì—­ìˆ˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ $\Delta x$ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

$$\Delta x = \Delta \frac{1}{\sqrt{P}} L$$

$L$ê³¼ $\sqrt{P}$ë¥¼ ì‚¬ìš©í•˜ë©´ í’€ ì¤€ë¹„ê¸ˆì„ ì €ì¥í•˜ê³  ì—…ë°ì´íŠ¸í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ë˜í•œ $\sqrt{P}$ë¥¼ ë§¤ë²ˆ ê³„ì‚°í•  í•„ìš”ë„ ì—†ìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ í•­ìƒ $\Delta \sqrt{P}$ì™€ ê·¸ ì—­ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

## í‹±

ì´ ì¥ì—ì„œ ë°°ì› ë“¯ì´ V2ì˜ ë¬´í•œ ê°€ê²© ë²”ìœ„ëŠ” V3ì—ì„œ ë” ì§§ì€ ê°€ê²© ë²”ìœ„ë¡œ ë¶„í• ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê° ì§§ì€ ê°€ê²© ë²”ìœ„ëŠ” ê²½ê³„(ìƒí•œ ë° í•˜í•œ ì§€ì )ë¡œ ì œí•œë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ê³„ì˜ ì¢Œí‘œë¥¼ ì¶”ì í•˜ê¸° ìœ„í•´ Uniswap V3ëŠ” *í‹±*ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.



![ê°€ê²© ë²”ìœ„ ë° í‹±](images/ticks_and_ranges.png)

V3ì—ì„œ ì „ì²´ ê°€ê²© ë²”ìœ„ëŠ” ê· ë“±í•˜ê²Œ ë¶„ì‚°ëœ ì´ì‚° í‹±ìœ¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. ê° í‹±ì€ ì¸ë±ìŠ¤ë¥¼ ê°€ì§€ë©° íŠ¹ì • ê°€ê²©ì— í•´ë‹¹í•©ë‹ˆë‹¤.

$$p(i) = 1.0001^i$$

ì—¬ê¸°ì„œ $p(i)$ëŠ” í‹± $i$ì—ì„œì˜ ê°€ê²©ì…ë‹ˆë‹¤. 1.0001ì˜ ê±°ë“­ì œê³±ì„ ì·¨í•˜ëŠ” ê²ƒì€ ë°”ëŒì§í•œ ì†ì„±ì„ ê°€ì§‘ë‹ˆë‹¤. ì¸ì ‘í•œ ë‘ í‹± ì‚¬ì´ì˜ ì°¨ì´ëŠ” 0.01% ë˜ëŠ” *1 ë² ì´ì‹œìŠ¤ í¬ì¸íŠ¸*ì…ë‹ˆë‹¤.

> ë² ì´ì‹œìŠ¤ í¬ì¸íŠ¸(1/100th of 1%, ë˜ëŠ” 0.01%, ë˜ëŠ” 0.0001)ëŠ” ê¸ˆìœµì—ì„œ ë°±ë¶„ìœ¨ì„ ì¸¡ì •í•˜ëŠ” ë‹¨ìœ„ì…ë‹ˆë‹¤. ì¤‘ì•™ ì€í–‰ì´ ê¸ˆë¦¬ ë³€ê²½ì„ ë°œí‘œí•  ë•Œ ë² ì´ì‹œìŠ¤ í¬ì¸íŠ¸ì— ëŒ€í•´ ë“¤ì–´ë´¤ì„ ê²ƒì…ë‹ˆë‹¤.

ìœ„ì—ì„œ ë…¼ì˜í•œ ë°”ì™€ ê°™ì´ Uniswap V3ëŠ” $P$ê°€ ì•„ë‹Œ $\sqrt{P}$ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì‹¤ì œ ê³µì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

$$\sqrt{p(i)} = \sqrt{1.0001}^i = 1.0001 ^{\frac{i}{2}}$$

ë”°ë¼ì„œ $\sqrt{p(0)} = 1$, $\sqrt{p(1)} = \sqrt{1.0001} \approx 1.00005$, $\sqrt{p(-1)} \approx 0.99995$ì™€ ê°™ì€ ê°’ì„ ì–»ìŠµë‹ˆë‹¤.

í‹±ì€ ì–‘ìˆ˜ì™€ ìŒìˆ˜ì¼ ìˆ˜ ìˆëŠ” ì •ìˆ˜ì´ë©°, ë¬¼ë¡  ë¬´í•œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Uniswap V3ëŠ” $\sqrt{P}$ë¥¼ ê³ ì • ì†Œìˆ˜ì  Q64.96 ìˆ«ìë¡œ ì €ì¥í•©ë‹ˆë‹¤. ì´ëŠ” ì •ìˆ˜ ë¶€ë¶„ì— 64ë¹„íŠ¸, ì†Œìˆ˜ ë¶€ë¶„ì— 96ë¹„íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ìœ ë¦¬ìˆ˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ê°€ê²©($\sqrt{P}$ì˜ ì œê³±ê³¼ ê°™ìŒ)ì€ $[2^{-128}, 2^{128}]$ ë²”ìœ„ ë‚´ì— ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í‹±ì€ ë‹¤ìŒ ë²”ìœ„ ë‚´ì— ìˆìŠµë‹ˆë‹¤.

$$[log_{1.0001}2^{-128}, log_{1.0001}{2^{128}}] = [-887272, 887272]$$

> Uniswap V3ì˜ ìˆ˜í•™ì— ëŒ€í•´ ë” ìì„¸íˆ ì•Œì•„ë³´ë ¤ë©´ [Atis Elsts](https://twitter.com/atiselsts)ì˜ [ê¸°ìˆ  ë…¸íŠ¸](https://atiselsts.github.io/pdfs/uniswap-v3-liquidity-math.pdf)ë¥¼ ì¶”ì²œí•˜ì§€ ì•Šì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.